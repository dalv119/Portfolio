# Реализация витрины для расчётов выплат курьерам 

## Описание проекта
Рассчитайте суммы выплат курьерам: реализуйте DWH и ETL-пайплайн для данных. 

## Задачи проекта
1. Изучить API системы доставки заказов.
2. Спроектировать структуру таблиц для слоёв в хранилище.
3. Реализовать DAG.
   
## Инструменты
> PostgreSQL, Airflow, REST-API, Python, MongoDB
### Навыки
- построение DWH; 
- написание ETL-пайплайна.

## Основной вывод

Реализована витрина для расчётов с курьерами. В ней рассчитываются суммы оплаты каждому курьеру за предыдущий месяц. Из витрины бизнес будет брать нужные данные в готовом виде.
Для этого было создано многослойное DWH и реализованы ETL-процессы, которые преобразовывают и перемещают данные от источников до конечных слоёв данных (STG-DDS-CDM).
Правила расчёта процента выплаты курьеру в зависимости от рейтинга, где r — это средний рейтинг курьера в расчётном месяце:
r < 4 — 5% от заказа, но не менее 100 р.;
4 <= r < 4.5 — 7% от заказа, но не менее 150 р.;
4.5 <= r < 4.9 — 8% от заказа, но не менее 175 р.;
4.9 <= r — 10% от заказа, но не менее 200 р.
